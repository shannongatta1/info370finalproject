---
title: "The Democratic Primaries 2018"
author: "Shannon Gatta, Andrea Jorge, Chen Manija, Julia Zaratan"
date: "November 30, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(plotly)
library(dplyr)
library(reticulate)
library(lattice)
library(ggplot2)
library(GGally)
library(gridExtra)


dems <- read.csv('./data/dem_candidates_prepped.csv', stringsAsFactors = FALSE)
scores <- read.csv('./data/model_accuracy_ML.csv', stringsAsFactors = FALSE)
pred <- read.csv('./data/model_test_predictions.csv', stringsAsFactors = FALSE)
```

## A Political Shift...

As the coming of a younger generation moves into politics^[1](https://fivethirtyeight.com/features/democrats-primaries-candidates-demographics/)^, so has the shift of what you could picture an elected official for the 2018 Elections to look like. Even so, the variance of gender, color, LGBTQ, among other features are still at a smaller percentage than the white male counterpart. There are reasons for this, such as the strong inclination for voters to elect someone that they share an identity with, an elected official who has held the seat for many years, etc.^[2](https://www.vox.com/polyarchy/2016/8/30/12697920/race-dividing-american-politics)^ We wanted to bring focus to the kind of candidates that are running for the Democratic Primaries across Representative, Governors, Senators, etc. while asking the question:

> "What factors are most influential in the success of a democratic candidate in the Democratic Primaries for 2018?"

We are going to predict the outcome with a binary return stating whether the candidate in question will lose or advance in the primaries. After seeing the surge of candidates with uncommon factors making waves in the media on both liberal and conservative platforms, we decided to compare the numbers ourselves to detect if the new candidates are the new norm or exceptions to the rules. We strive to connect with the politically active community, to bring facts to voters, on both sides of the spectrum. Diversity for liberals and conservatives alike bring a unique perspective to their office role, and the uncommon candidate should both be informed whether or not the war has been won, and their diversity truly brings favorable results to their campaign, or if this is just the beginning.

## The Data

Data and variable explanation go here.

## Exploring The Dataset

In order to narrow down the features we want to focus on, We will explore covariate values we found as an additive to building our statistical model. 

### LGBTQ+

29% of LGBTQ advanced in the primaries, which is little less than 2% of the number of candidates that ran overall in the primaries. Perhaps success for the LGBTQ in the Democratic Party is a growing trend in comparison to previous years but is not projecting to be the best factor in predicting a successful candidate. 

```{r example, echo=FALSE}

ggplot(data = dems, aes(x = Primary.Status, fill = LGBTQ.)) +
  geom_bar(position=position_dodge()) + 
  ggtitle("Results for LGBTQ+ in the Primary Races") + 
  geom_text(stat="count", aes(label = ..count..), position = position_dodge(.9), vjust = .5)
#ggplotly(new)
#htmltools::tagList(list(new))

```


### Race

Based on the findings, it is first determined that 32% of all candidates advanced. Therefore, if race was not related to the likelihood that a candidate advances, then 32% of each race group (White, nonwhite, and unknown) would advance. To look at the overall makeup of the candidates, the pie chart shows that 55.7% of the candidates are white, 19.2% are nonwhite, and 25% are unknown. 

In the stacked bar chart that groups by Primary Status and shows the percentages of each for each bar, 59.2% of the advanced candidates were white, 23.8% were nonwhite, and 17.0% were unknown. Since these proportions are not equal the overall makeup, race could be an influential factor on the primary status of a candidate. To see this in a different way, the stacked bar chart that groups first by race and stacks by primary status shows that the percentage of white that advanced is higher than any other race category that advanced.  

```{r race, echo=FALSE}
source("./R/julia.R")

race_pie_chart 

status_race_stacked

race_status_stacked
```


## Machine Learning

The following two graphs depicted are comparing the number of accurate and inaccurate matches of the machine learning algorithm used to predict and the outcomes. Both algorithms show a consistent pattern of predicting the candidates who lost the primary, with Random Forest Regression at 70% and K Nearest Neighbors at 54%.

```{r predictions, echo=FALSE}

knn_agg <- count(pred, outcome, knn_pred)
rfc_agg <- count(pred, outcome, rfc_pred)

ggplot(knn_agg, aes(outcome, knn_pred, color=n)) + 
     geom_point( size = (knn_agg$n)) +
     xlim(-.5, 1.5)+ylim(-1, 1.5) +
     ggtitle("Number of KNN Predictions and Outcome Correlations") + 
     geom_text(aes(label=knn_agg$n), size=5, color = "white")

ggplot(rfc_agg, aes(outcome, rfc_pred, color=n)) + 
     geom_point( size = (rfc_agg$n)) +
     xlim(-.5, 1.5)+ylim(-1, 1.5) +
     ggtitle("Number of RFC Predictions and Outcome Correlations") + 
     geom_text(aes(label=rfc_agg$n), size=5, color = "white")



```


This bar graph depicts the overall accuracy scores received by the algorithms in comparison to the test outcomes.

```{r accuracy, echo=FALSE}

ggplot(data = scores, aes(x = Model.Type, y = Score, fill=Model.Type )) +
  geom_bar(stat = "identity") + 
  ggtitle("Accuracy Scores for Machine Learning Algorithms") + 
  geom_text(aes(label=round(scores$Score, 2)), size=5, color = "black")


```


## Discussion




## Conclusion